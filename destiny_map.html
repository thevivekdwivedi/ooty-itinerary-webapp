<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Destiny – The Farm Resort Itinerary Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <style>
    #map { height: 500px; width: 100%; }
  </style>
</head>
<body>
  <h4>Timeline</h4>
  <input type="range" id="timeSlider" min="0" max="5" value="0" step="1" style="width:100%"> 
  <div id="timeLabel" style="margin-top:5px; font-weight:bold;">Select a time to highlight an activity</div>
  <div id="map"></div>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script>
    var map = L.map('map').setView([11.38, 76.75], 11);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org">OpenStreetMap</a> contributors'
    }).addTo(map);
    // Define custom icons
    var defaultIcon = L.icon({
      iconUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png',
      iconSize: [25, 41],
      iconAnchor: [12, 41],
      popupAnchor: [1, -34],
      shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
      shadowSize: [41, 41]
    });
    var highlightIcon = L.icon({
      iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x-red.png',
      iconSize: [25, 41],
      iconAnchor: [12, 41],
      popupAnchor: [1, -34],
      shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
      shadowSize: [41, 41]
    });
    // Timeline entries with time, name and coordinates
    var timeline = [
      {time:'15:00 18 Oct', name:'Farm exploration at Destiny Resort (weather permitting; indoor activities if rain)', coords:[11.3560,76.7640]},
      {time:'09:00 19 Oct', name:'Avalanche Lake & Emerald Dam (weather permitting; indoor workshops if rainy)', coords:[11.3660,76.7870]},
      {time:'14:00 19 Oct', name:'Farm activities (archery, garden – weather permitting)', coords:[11.3560,76.7640]},
      {time:'18:00 19 Oct', name:'Barbecue dinner (outdoors or indoors depending on weather)', coords:[11.3560,76.7640]},
      {time:'10:00 20 Oct', name:'Ooty Lake boating (weather permitting)', coords:[11.4034,76.6952]},
      {time:'11:30 20 Oct', name:'Botanical Garden (weather permitting)', coords:[11.4127,76.7031]}
    ];
    // Create markers and store them
    var markers = [];
    timeline.forEach(function(item) {
      var marker = L.marker(item.coords, {icon: defaultIcon}).addTo(map).bindPopup(item.name);
      markers.push(marker);
    });
    // Draw route connecting the locations in order
    var route = timeline.map(function(entry) { return entry.coords; });
    var polyline = L.polyline(route, {color:'blue', weight:3}).addTo(map);
    map.fitBounds(polyline.getBounds());
    // Handle slider change
    var slider = document.getElementById('timeSlider');
    var label = document.getElementById('timeLabel');
    function updateHighlight(index) {
      for (var i = 0; i < markers.length; i++) {
        markers[i].setIcon(defaultIcon);
      }
      markers[index].setIcon(highlightIcon);
      label.textContent = timeline[index].time + ' – ' + timeline[index].name;
      map.panTo(timeline[index].coords);
      markers[index].openPopup();
    }
    slider.addEventListener('input', function(e) {
      var idx = parseInt(e.target.value);
      updateHighlight(idx);
    });
    // Initialize with first time entry
    updateHighlight(0);
  </script>
</body>
</html>